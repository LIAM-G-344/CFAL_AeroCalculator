from pygasflow.solvers import rayleigh_solver
import matplotlib.pyplot as plt
from matplotlib.figure import Figure
import numpy as np
import pandas as pd

#just a helper function
def rayleigh(x_value, gamma_input):
    results = rayleigh_solver("m", x_value, gamma=gamma_input, to_dict=True)
    return results

def rayleigh_graph(gamma,range_input,resolution):
    range_high = range_input[1]
    range_low = range_input[0]

    #list holding all x values
    x_list = []

    #makes the possible ratio y value graphs an array
    m = []
    prs = []
    drs = []
    trs = []
    tprs = []
    ttrs = []
    urs = []
    eps = []

    #graph object
    fig = Figure()
    axis = fig.subplots()

    #optimization by pregeneration
    if (gamma == 1.4) and (range_low == 0) and (range_high == 5) and (resolution == 20):
        m = [np.float64(0.0), np.float64(0.05), np.float64(0.1), np.float64(0.15000000000000002), np.float64(0.2), np.float64(0.25), np.float64(0.30000000000000004), np.float64(0.35000000000000003), np.float64(0.4), np.float64(0.45), np.float64(0.5), np.float64(0.55), np.float64(0.6000000000000001), np.float64(0.65), np.float64(0.7000000000000001), np.float64(0.75), np.float64(0.8), np.float64(0.8500000000000001), np.float64(0.9), np.float64(0.9500000000000001), np.float64(1.0), np.float64(1.05), np.float64(1.1), np.float64(1.1500000000000001), np.float64(1.2000000000000002), np.float64(1.25), np.float64(1.3), np.float64(1.35), np.float64(1.4000000000000001), np.float64(1.4500000000000002), np.float64(1.5), np.float64(1.55), np.float64(1.6), np.float64(1.6500000000000001), np.float64(1.7000000000000002), np.float64(1.75), np.float64(1.8), np.float64(1.85), np.float64(1.9000000000000001), np.float64(1.9500000000000002), np.float64(2.0), np.float64(2.0500000000000003), np.float64(2.1), np.float64(2.15), np.float64(2.2), np.float64(2.25), np.float64(2.3000000000000003), np.float64(2.35), np.float64(2.4000000000000004), np.float64(2.45), np.float64(2.5), np.float64(2.5500000000000003), np.float64(2.6), np.float64(2.6500000000000004), np.float64(2.7), np.float64(2.75), np.float64(2.8000000000000003), np.float64(2.85), np.float64(2.9000000000000004), np.float64(2.95), np.float64(3.0), np.float64(3.0500000000000003), np.float64(3.1), np.float64(3.1500000000000004), np.float64(3.2), np.float64(3.25), np.float64(3.3000000000000003), np.float64(3.35), np.float64(3.4000000000000004), np.float64(3.45), np.float64(3.5), np.float64(3.5500000000000003), np.float64(3.6), np.float64(3.6500000000000004), np.float64(3.7), np.float64(3.75), np.float64(3.8000000000000003), np.float64(3.85), np.float64(3.9000000000000004), np.float64(3.95), np.float64(4.0), np.float64(4.05), np.float64(4.1000000000000005), np.float64(4.15), np.float64(4.2), np.float64(4.25), np.float64(4.3), np.float64(4.3500000000000005), np.float64(4.4), np.float64(4.45), np.float64(4.5), np.float64(4.55), np.float64(4.6000000000000005), np.float64(4.65), np.float64(4.7), np.float64(4.75), np.float64(4.800000000000001), np.float64(4.8500000000000005), np.float64(4.9), np.float64(4.95)]
        prs = [np.float64(2.4), np.float64(2.3916292974588935), np.float64(2.366863905325444), np.float64(2.32670867668444), np.float64(2.2727272727272725), np.float64(2.206896551724138), np.float64(2.131438721136767), np.float64(2.0486555697823303), np.float64(1.9607843137254901), np.float64(1.8698870276587454), np.float64(1.7777777777777777), np.float64(1.6859852476290833), np.float64(1.5957446808510638), np.float64(1.5080113100848256), np.float64(1.4234875444839858), np.float64(1.3426573426573425), np.float64(1.2658227848101264), np.float64(1.1931394481730053), np.float64(1.1246485473289598), np.float64(1.0603048376408217), np.float64(1.0), np.float64(0.9435816787890702), np.float64(0.8908685968819599), np.float64(0.8416622830089426), np.float64(0.7957559681697611), np.float64(0.7529411764705882), np.float64(0.7130124777183601), np.float64(0.6757708010699703), np.float64(0.641025641025641), np.float64(0.6085964244960059), np.float64(0.5783132530120482), np.float64(0.5500171880371261), np.float64(0.5235602094240837), np.float64(0.4988049464823859), np.float64(0.47562425683709864), np.float64(0.45390070921985815), np.float64(0.43352601156069365), np.float64(0.41440041440041436), np.float64(0.39643211100099107), np.float64(0.3795366490076697), np.float64(0.36363636363636365), np.float64(0.3486598387448245), np.float64(0.3345413994981879), np.float64(0.3212206384260189), np.float64(0.30864197530864196), np.float64(0.2967542503863988), np.float64(0.2855103497501784), np.float64(0.27486686136402677), np.float64(0.26478375992939096), np.float64(0.25522411867921513), np.float64(0.24615384615384614), np.float64(0.2375414460335527), np.float64(0.2293577981651376), np.float64(0.22157595900844754), np.float64(0.2141709798322327), np.float64(0.20711974110032363), np.float64(0.2004008016032064), np.float64(0.19399426100311198), np.float64(0.18788163457022072), np.float64(0.1820457389919217), np.float64(0.17647058823529413), np.float64(0.1711412985346026), np.float64(0.16604400166044), np.float64(0.16116576570526805), np.float64(0.15649452269170577), np.float64(0.15201900237529692), np.float64(0.14772867167302717), np.float64(0.14361367920294407), np.float64(0.13966480446927373), np.float64(0.13587341127183172), np.float64(0.1322314049586777), np.float64(0.12873119317724674), np.float64(0.12536564981195153), np.float64(0.1221280818258148), np.float64(0.1190121987503719), np.float64(0.11601208459214502), np.float64(0.11312217194570134), np.float64(0.11033721812288808), np.float64(0.1076522831255046), np.float64(0.1050627093046162), np.float64(0.10256410256410256), np.float64(0.10015231497903061), np.float64(0.0978234287111763), np.float64(0.09557374111462874), np.float64(0.09339975093399751), np.float64(0.0912981455064194), np.float64(0.08926578888640929), np.float64(0.0872997108197079), np.float64(0.08539709649871903), np.float64(0.08355527703796542), np.float64(0.08177172061328791), np.float64(0.08004402421331734), np.float64(0.07836990595611285), np.float64(0.07674719792782565), np.float64(0.07517383950385265), np.float64(0.07364787111622555), np.float64(0.07216742843396678), np.float64(0.07073073692586533), np.float64(0.06933610677760442), np.float64(0.0679819281374368)]
        drs = [np.float64('inf'), np.float64(167.24999999999997), np.float64(42.24999999999999), np.float64(19.101851851851848), np.float64(10.999999999999998), np.float64(7.25), np.float64(5.212962962962962), np.float64(3.98469387755102), np.float64(3.1874999999999996), np.float64(2.6409465020576133), np.float64(2.2500000000000004), np.float64(1.9607438016528922), np.float64(1.7407407407407403), np.float64(1.5695266272189348), np.float64(1.4336734693877549), np.float64(1.3240740740740742), np.float64(1.2343749999999998), np.float64(1.1600346020761243), np.float64(1.0977366255144032), np.float64(1.0450138504155124), np.float64(1.0), np.float64(0.9612622826908541), np.float64(0.927685950413223), np.float64(0.8983931947069943), np.float64(0.8726851851851851), np.float64(0.85), np.float64(0.8298816568047337), np.float64(0.8119570187471422), np.float64(0.7959183673469388), np.float64(0.7815101070154578), np.float64(0.7685185185185187), np.float64(0.7567637877211237), np.float64(0.74609375), np.float64(0.7363789409243954), np.float64(0.7275086505190311), np.float64(0.7193877551020408), np.float64(0.7119341563786008), np.float64(0.7050766983199416), np.float64(0.6987534626038782), np.float64(0.6929103659872891), np.float64(0.6875), np.float64(0.6824806662700772), np.float64(0.6778155706727135), np.float64(0.673472147106544), np.float64(0.6694214876033058), np.float64(0.6656378600823044), np.float64(0.6620982986767485), np.float64(0.6587822544137618), np.float64(0.6556712962962963), np.float64(0.6527488546438983), np.float64(0.65), np.float64(0.6474112520825324), np.float64(0.6449704142011834), np.float64(0.6426664293342826), np.float64(0.6404892546867855), np.float64(0.6384297520661156), np.float64(0.6364795918367346), np.float64(0.6346311685646865), np.float64(0.6328775267538644), np.float64(0.6312122953174376), np.float64(0.6296296296296297), np.float64(0.6281241601719968), np.float64(0.6266909469302809), np.float64(0.6253254388175022), np.float64(0.6240234375), np.float64(0.6227810650887574), np.float64(0.6215947352310988), np.float64(0.6204611271998218), np.float64(0.6193771626297577), np.float64(0.6183399845970735), np.float64(0.6173469387755102), np.float64(0.6163955564372148), np.float64(0.6154835390946501), np.float64(0.6146087446049915), np.float64(0.6137691745799854), np.float64(0.6129629629629629), np.float64(0.6121883656509696), np.float64(0.6114437510541406), np.float64(0.6107275914968223), np.float64(0.6100384553757411), np.float64(0.609375), np.float64(0.6087359650459787), np.float64(0.6081201665675192), np.float64(0.6075264915082014), np.float64(0.6069538926681783), np.float64(0.6064013840830449), np.float64(0.6058680367766359), np.float64(0.6053529748535693), np.float64(0.6048553719008264), np.float64(0.6043744476707487), np.float64(0.6039094650205761), np.float64(0.6034597270861006), np.float64(0.6030245746691871), np.float64(0.6026033838208655), np.float64(0.6021955636034404), np.float64(0.6018005540166205), np.float64(0.6014178240740741), np.float64(0.6010468700180679), np.float64(0.6006872136609746), np.float64(0.6003384008434514)]
        trs = [np.float64(0.0), np.float64(0.014299726741159308), np.float64(0.056020447463324116), np.float64(0.12180539848856983), np.float64(0.20661157024793392), np.float64(0.3043995243757432), np.float64(0.40887279197650245), np.float64(0.5141312313410202), np.float64(0.6151480199923108), np.float64(0.7080366929818078), np.float64(0.7901234567901233), np.float64(0.8598702422049277), np.float64(0.916704391127207), np.float64(0.9608064520427355), np.float64(0.9928952267575134), np.float64(1.0140349161328182), np.float64(1.025476686428457), np.float64(1.0285378091633068), np.float64(1.0245158275574031), np.float64(1.0146323297238877), np.float64(1.0), np.float64(0.981606888962406), np.float64(0.9603126968616228), np.float64(0.9368529147011692), np.float64(0.9118476876640235), np.float64(0.8858131487889274), np.float64(0.8591736808157066), np.float64(0.832274104992271), np.float64(0.8053911900065747), np.float64(0.7787441506293511), np.float64(0.7525039918710986), np.float64(0.7268016743948824), np.float64(0.7017351498040075), np.float64(0.6773753549445931), np.float64(0.6537712733694246), np.float64(0.6309541773552639), np.float64(0.6089411607471016), np.float64(0.5877380650755424), np.float64(0.5673418912640547), np.float64(0.5477427783417402), np.float64(0.5289256198347108), np.float64(0.5108713784528656), np.float64(0.4935581505838892), np.float64(0.47696202405116156), np.float64(0.4610577655845145), np.float64(0.445819368432117), np.float64(0.43122048541854224), np.float64(0.41723476842682367), np.float64(0.4038361316487092), np.float64(0.3909989529103816), np.float64(0.378698224852071), np.float64(0.3669096656405824), np.float64(0.35560979715512164), np.float64(0.3447759971498292), np.float64(0.334386530710757), np.float64(0.3244205653480798), np.float64(0.3148581732603483), np.float64(0.305680323646661), np.float64(0.29686886739982266), np.float64(0.2884065160682123), np.float64(0.28027681660899656), np.float64(0.272464123156383), np.float64(0.2649535667840313), np.float64(0.25773102404091286), np.float64(0.2507830848768493), np.float64(0.24409702044109433), np.float64(0.2376607511292773), np.float64(0.2314628151663283), np.float64(0.22549233794201182), np.float64(0.21973900225839413), np.float64(0.2141930196024862), np.float64(0.20884510252039612), np.float64(0.20368643813993634), np.float64(0.19870866286535904), np.float64(0.19390383824963897), np.float64(0.1892644280355236), np.float64(0.18478327634569316), np.float64(0.18045358699416686), np.float64(0.17626890388505517), np.float64(0.17222309246046616), np.float64(0.168310322156476), np.float64(0.16452504982429608), np.float64(0.1608620040728661), np.float64(0.1573161704889021), np.float64(0.15388277769075806), np.float64(0.1505572841732109), np.float64(0.14733536590133522), np.float64(0.14421290461292452), np.float64(0.14118597679036726), np.float64(0.13825084326444706), np.float64(0.1354039394141667), np.float64(0.1326418659283568), np.float64(0.12996138009650063), np.float64(0.1273593875978634), np.float64(0.12483293475963955), np.float64(0.12237920125642084), np.float64(0.11999549322482041), np.float64(0.11767923676857202), np.float64(0.11542797183083947), np.float64(0.11323934641183192)]
        tprs = [np.float64(1.267876290521218), np.float64(1.2656666279183149), np.float64(1.2591455962360274), np.float64(1.2486261957221982), np.float64(1.2345958839559574), np.float64(1.2176717387998708), np.float64(1.1985487768437173), np.float64(1.1779489169241812), np.float64(1.1565766050531407), np.float64(1.1350847879994355), np.float64(1.114052503180089), np.float64(1.0939734045470222), np.float64(1.0752533221360672), np.float64(1.0582144433052096), np.float64(1.0431037354534476), np.float64(1.0301035855633078), np.float64(1.0193431206815915), np.float64(1.0109091632699487), np.float64(1.0048561934716151), np.float64(1.0012150096100243), np.float64(1.0), np.float64(1.0012150788833514), np.float64(1.0048584168961385), np.float64(1.0109261308192004), np.float64(1.0194151039430308), np.float64(1.030325098737606), np.float64(1.0436603056435614), np.float64(1.0594304508490946), np.float64(1.0776515649739764), np.float64(1.0983464953173294), np.float64(1.1215452274944158), np.float64(1.1472850680899511), np.float64(1.1756107282814623), np.float64(1.206574338972486), np.float64(1.2402354205005284), np.float64(1.2766608241241706), np.float64(1.3159246579484296), np.float64(1.358108206456164), np.float64(1.403299850155586), np.float64(1.451594989848671), np.float64(1.5030959785260414), np.float64(1.5579120627842027), np.float64(1.6161593348491063), np.float64(1.6779606957040871), np.float64(1.7434458294048771), np.float64(1.8127511883767675), np.float64(1.8860199892963208), np.float64(1.9634022190373492), np.float64(2.045054650089292), np.float64(2.13114086482131), np.float64(2.221831287956654), np.float64(2.3173032266311564), np.float64(2.417740917431193), np.float64(2.523335579835627), np.float64(2.6342854755200826), np.float64(2.7507959730180347), np.float64(2.873079617269996), np.float64(3.00135620362843), np.float64(3.135852855921264), np.float64(3.2768041082103214), np.float64(3.4244519899125363), np.float64(3.5790461139812364), np.float64(3.7408437678720436), np.float64(3.9101100070429644), np.float64(4.087117750761371), np.float64(4.2721478800115396), np.float64(4.465489337315622), np.float64(4.667439228298364), np.float64(4.878302924841751), np.float64(5.098394169690073), np.float64(5.3280351823789465), np.float64(5.567556766373597), np.float64(5.817298417312291), np.float64(6.077608432260589), np.float64(6.348844019890542), np.float64(6.631371411507071), np.float64(6.92556597285068), np.float64(7.231812316612216), np.float64(7.550504415601063), np.float64(7.882045716513553), np.float64(8.226849254252961), np.float64(8.585337766756934), np.float64(8.957943810291907), np.float64(9.345109875177716), np.float64(9.747288501908807), np.float64(10.164942397641225), np.float64(10.59854455301728), np.float64(11.048578359302232), np.float64(11.515537725809326), np.float64(11.999927197591663), np.float64(12.502262073381074), np.float64(13.023068523755764), np.float64(13.562883709520182), np.float64(14.12225590028149), np.float64(14.701744593208977), np.float64(15.30192063196292), np.float64(15.923366325781288), np.float64(16.56667556871318), np.float64(17.232453958988753), np.float64(17.92131891851638)]
        ttrs = [np.float64(0.0), np.float64(0.01192239717044157), np.float64(0.04677707363187564), np.float64(0.101961268984807), np.float64(0.1735537190082645), np.float64(0.2568370986920333), np.float64(0.34686041852673294), np.float64(0.438939538757396), np.float64(0.5290272971933873), np.float64(0.6139268158729758), np.float64(0.691358024691358), np.float64(0.7599103265486048), np.float64(0.8189225894069717), np.float64(0.8683288310336221), np.float64(0.9084991324831249), np.float64(0.9400948701648001), np.float64(0.9639480852427497), np.float64(0.980967935489504), np.float64(0.9920728263514185), np.float64(0.9981445543658743), np.float64(1.0), np.float64(0.9983760066488471), np.float64(0.9939236412517797), np.float64(0.987208758866357), np.float64(0.9787165180927186), np.float64(0.9688581314878894), np.float64(0.9579786541095129), np.float64(0.9463650135516282), np.float64(0.9342537804076264), np.float64(0.9218383883074945), np.float64(0.9092756568442442), np.float64(0.8966915657846861), np.float64(0.8841862887530494), np.float64(0.8718385297599368), np.float64(0.8597092244807932), np.float64(0.8478446758211357), np.float64(0.8362791940926859), np.float64(0.8250373088497928), np.float64(0.8141356139639183), np.float64(0.8035843010588613), np.float64(0.793388429752066), np.float64(0.7835489767020827), np.float64(0.7740636994990661), np.float64(0.7649278460720503), np.float64(0.7561347355586039), np.float64(0.7476762324746962), np.float64(0.7395431324927999), np.float64(0.7317254751285419), np.float64(0.7242127960900187), np.float64(0.7169943298994123), np.float64(0.7100591715976331), np.float64(0.7033964048384665), np.float64(0.6969952024240382), np.float64(0.6908449042889703), np.float64(0.6849350770725341), np.float64(0.679255558697542), np.float64(0.6737964907771455), np.float64(0.6685483411755513), np.float64(0.6635019186386036), np.float64(0.6586483810707798), np.float64(0.6539792387543252), np.float64(0.6494863535740281), np.float64(0.6451619351191162), np.float64(0.640998534375087), np.float64(0.6369890355871972), np.float64(0.6331266467690883), np.float64(0.6294048892407027), np.float64(0.6258175865059602), np.float64(0.6223588527199525), np.float64(0.6190230809454178), np.float64(0.6158049313571476), np.float64(0.6126993195192122), np.float64(0.6097014048322094), np.float64(0.6068065792250902), np.float64(0.6040104561476254), np.float64(0.601308859904528), np.float64(0.5986978153600457), np.float64(0.5961735380319787), np.float64(0.5937324245861608), np.float64(0.5913710437361256), np.float64(0.589086127547666), np.float64(0.5868745631440827), np.float64(0.5847333848048683), np.float64(0.5826597664482711), np.float64(0.5806510144864603), np.float64(0.5787045610407793), np.float64(0.5768179575037273), np.float64(0.5749888684337812), np.float64(0.573215065768891), np.float64(0.5714944233444079), np.float64(0.5698249117012848), np.float64(0.5682045931705983), np.float64(0.5666316172207427), np.float64(0.5651042160540196), np.float64(0.5636207004397725), np.float64(0.5621794557716832), np.float64(0.5607789383373274), np.float64(0.5594176717885992), np.float64(0.5580942438021088), np.float64(0.5568073029191785)]
        urs = [np.float64(0.0), np.float64(0.005979073243647236), np.float64(0.02366863905325444), np.float64(0.05235094522539991), np.float64(0.09090909090909093), np.float64(0.13793103448275862), np.float64(0.19182948490230908), np.float64(0.2509603072983355), np.float64(0.3137254901960785), np.float64(0.37865212310089597), np.float64(0.4444444444444444), np.float64(0.5100105374077978), np.float64(0.5744680851063831), np.float64(0.6371347785108389), np.float64(0.6975088967971531), np.float64(0.7552447552447551), np.float64(0.8101265822784811), np.float64(0.8620432513049965), np.float64(0.9109653233364574), np.float64(0.9569251159708415), np.float64(1.0), np.float64(1.0402988008649499), np.float64(1.0779510022271717), np.float64(1.1130983692793268), np.float64(1.1458885941644563), np.float64(1.1764705882352942), np.float64(1.2049910873440286), np.float64(1.2315922849500212), np.float64(1.2564102564102566), np.float64(1.279573982502853), np.float64(1.3012048192771082), np.float64(1.3214162942591958), np.float64(1.3403141361256545), np.float64(1.357996466798296), np.float64(1.3745541022592154), np.float64(1.3900709219858156), np.float64(1.4046242774566475), np.float64(1.4182854182854183), np.float64(1.4311199207135776), np.float64(1.4431881078516644), np.float64(1.4545454545454546), np.float64(1.4652429723251255), np.float64(1.4753275717870087), np.float64(1.4848424011242725), np.float64(1.4938271604938271), np.float64(1.502318392581144), np.float64(1.510349750178444), np.float64(1.5179522418828382), np.float64(1.5251544571932922), np.float64(1.5319827723719892), np.float64(1.5384615384615385), np.float64(1.5446132528331766), np.float64(1.5504587155963303), np.float64(1.5560171721368232), np.float64(1.5613064429769767), np.float64(1.5663430420711975), np.float64(1.5711422845691383), np.float64(1.5757183849977772), np.float64(1.5800845467355566), np.float64(1.5842530435771986), np.float64(1.588235294117647), np.float64(1.592041929618141), np.float64(1.5956828559568288), np.float64(1.5991673102105228), np.float64(1.6025039123630673), np.float64(1.6057007125890734), np.float64(1.6087652345192665), np.float64(1.61170451485504), np.float64(1.6145251396648046), np.float64(1.6172332776629772), np.float64(1.6198347107438018), np.float64(1.6223348620162523), np.float64(1.624738821562892), np.float64(1.6270513701244183), np.float64(1.6292770008925916), np.float64(1.6314199395770392), np.float64(1.6334841628959276), np.float64(1.6354734156265087), np.float64(1.6373912263389252), np.float64(1.6392409219252742), np.float64(1.641025641025641), np.float64(1.6427483464435495), np.float64(1.6444118366348743), np.float64(1.646018756346694), np.float64(1.6475716064757162), np.float64(1.6490727532097007), np.float64(1.6505244365097078), np.float64(1.651928777985923), np.float64(1.6532877882152006), np.float64(1.6546033735443104), np.float64(1.6558773424190802), np.float64(1.6571114112762022), np.float64(1.658307210031348), np.float64(1.6594662871944104), np.float64(1.6605901146401054), np.float64(1.661680092059839), np.float64(1.6627375511185951), np.float64(1.6637637593386676), np.float64(1.6647599237302826), np.float64(1.6657271941875451)]
        eps = [np.float64('inf'), np.float64(15.738276826280075), np.float64(10.948700657848867), np.float64(8.213111791252786), np.float64(6.3401820746197215), np.float64(4.954537007600048), np.float64(3.8870263844631445), np.float64(3.045652321161623), np.float64(2.373967803536492), np.float64(1.8342857773753505), np.float64(1.3998453944982463), np.float64(1.050758347581674), np.float64(0.7717362954044223), np.float64(0.550729794963843), np.float64(0.3780653409257081), np.float64(0.2458700565552213), np.float64(0.14767085807304925), np.float64(0.07810435680725863), np.float64(0.03270010275875324), np.float64(0.007714363952711005), np.float64(-0.0), np.float64(0.00690293837467219), np.float64(0.026178785175359712), np.float64(0.05592500893722812), np.float64(0.09452537919317616), np.float64(0.14060417958439983), np.float64(0.19298829921584862), np.float64(0.2506757254586003), np.float64(0.31280927122018376), np.float64(0.37865460398467116), np.float64(0.44758182457509216), np.float64(0.5190499850858881), np.float64(0.5925940476310829), np.float64(0.6678138753750872), np.float64(0.744364919754604), np.float64(0.8219503265630204), np.float64(0.9003142314539778), np.float64(0.9792360545865492), np.float64(1.058525636266999), np.float64(1.1380190818743778), np.float64(1.2175752061512626), np.float64(1.297072484949549), np.float64(1.3764064374315046), np.float64(1.4554873740954652), np.float64(1.5342384562755376), np.float64(1.6125940213244128), np.float64(1.6904981348284231), np.float64(1.767903337170705), np.float64(1.8447695567535327), np.float64(1.9210631663801272), np.float64(1.996756162816051), np.float64(2.071825452512741), np.float64(2.1462522289736037), np.float64(2.2200214293529394), np.float64(2.2931212596631743), np.float64(2.3655427794790835), np.float64(2.437279538312457), np.float64(2.5083272569234714), np.float64(2.5786835477659875), np.float64(2.648347669558538), np.float64(2.7173203116518714), np.float64(2.7856034044454177), np.float64(2.8531999526036333), np.float64(2.92011388825151), np.float64(2.986349941696896), np.float64(3.051913527544736), np.float64(3.116810644342133), np.float64(3.18104778612984), np.float64(3.2446318644805165), np.float64(3.3075701397815487), np.float64(3.369870160674184), np.float64(3.431539710694564), np.float64(3.4925867612785844), np.float64(3.5530194303939884), np.float64(3.612845946151492), np.float64(3.672074614824055), np.float64(3.730713792770934), np.float64(3.7887718618222865), np.float64(3.8462572077319876), np.float64(3.903178201351697), np.float64(3.9595431822193023), np.float64(4.015360444289849), np.float64(4.070638223568129), np.float64(4.125384687429227), np.float64(4.179607925437451), np.float64(4.233315941495232), np.float64(4.28651664717235), np.float64(4.339217856082418), np.float64(4.39142727918825), np.float64(4.4431525209307265), np.float64(4.494401076087315), np.float64(4.545180327276634), np.float64(4.5954975430345195), np.float64(4.645359876395196), np.float64(4.694774363918236), np.float64(4.743747925108473), np.float64(4.792287362181704), np.float64(4.840399360134037), np.float64(4.888090487077381), np.float64(4.935367194807472)]
        x_list = [0.0, 0.05, 0.1, 0.15000000000000002, 0.2, 0.25, 0.30000000000000004, 0.35000000000000003, 0.4, 0.45, 0.5, 0.55, 0.6000000000000001, 0.65, 0.7000000000000001, 0.75, 0.8, 0.8500000000000001, 0.9, 0.9500000000000001, 1.0, 1.05, 1.1, 1.1500000000000001, 1.2000000000000002, 1.25, 1.3, 1.35, 1.4000000000000001, 1.4500000000000002, 1.5, 1.55, 1.6, 1.6500000000000001, 1.7000000000000002, 1.75, 1.8, 1.85, 1.9000000000000001, 1.9500000000000002, 2.0, 2.0500000000000003, 2.1, 2.15, 2.2, 2.25, 2.3000000000000003, 2.35, 2.4000000000000004, 2.45, 2.5, 2.5500000000000003, 2.6, 2.6500000000000004, 2.7, 2.75, 2.8000000000000003, 2.85, 2.9000000000000004, 2.95, 3.0, 3.0500000000000003, 3.1, 3.1500000000000004, 3.2, 3.25, 3.3000000000000003, 3.35, 3.4000000000000004, 3.45, 3.5, 3.5500000000000003, 3.6, 3.6500000000000004, 3.7, 3.75, 3.8000000000000003, 3.85, 3.9000000000000004, 3.95, 4.0, 4.05, 4.1000000000000005, 4.15, 4.2, 4.25, 4.3, 4.3500000000000005, 4.4, 4.45, 4.5, 4.55, 4.6000000000000005, 4.65, 4.7, 4.75, 4.800000000000001, 4.8500000000000005, 4.9, 4.95]

    else:
        # find range, and set current x to the lowest x value to be found
        x_range = range_high - range_low
        current_x = range_low

        # resolution param is points grpahed / in. must take range into account
        num_points = resolution * x_range
        for i in range(num_points):
            #find current x value with respect to iteration # and resoultion defined
            current_x += 1/resolution
            x_list.append(current_x)

            #get values for current_x
            rayleigh_dict = rayleigh(current_x, gamma)

            #creates arrays for each possible graph's y values
            m.append(rayleigh_dict['m'])
            prs.append(rayleigh_dict['prs'])
            drs.append(rayleigh_dict['drs'])
            trs.append(rayleigh_dict['trs'])
            tprs.append(rayleigh_dict['tprs'])
            ttrs.append(rayleigh_dict['ttrs'])
            urs.append(rayleigh_dict['urs'])
            eps.append(rayleigh_dict['eps'])

    axis.plot(x_list, m, label="m")
    axis.plot(x_list, prs, label="prs")
    axis.plot(x_list, drs, label="drs")
    axis.plot(x_list, trs, label="trs")
    axis.plot(x_list, tprs, label="tprs")
    axis.plot(x_list, ttrs, label="ttrs")
    axis.plot(x_list, urs, label="urs")
    axis.plot(x_list, eps, label="eps")

    axis.set_xlabel("x")
    axis.set_ylabel("y")
    axis.set_ylim(0,3)
    fig.set_size_inches(5, 3)
    fig.tight_layout()
    axis.legend()

    return(fig)

#create a table
#no optimization with this one. if we need it here, we gotta be down bad for cpu power
def rayleigh_data_table(gamma,range_input):
    range_high = range_input[1]
    range_low = range_input[0]

    x_range = range_high - range_low
    current_x = range_low

    # table object
    table = pd.DataFrame(columns=['Mach', 'Gamma', 'prs', 'drs', 'trs', 'tprs', 'ttrs','urs','eps'])

    #extremely similar logic to what is above. goes to 11 because 10 only goes to 4.5 as zero is the first one
    for i in range((x_range*2)+1):
        #value at each 0.5 mach increace (ie: each 0.5 increace in x)
        #round because somtimes it adds 0.000000000000000001 extra or somthing like that. weird fix but it works
        current_x += 0.5
        rayleigh_dict = rayleigh(round(i/2,1),gamma)

        #add another row to the table with ze info
        table.loc[len(table)] = [round(current_x,1),gamma,rayleigh_dict['prs'],rayleigh_dict['drs'],rayleigh_dict['trs'],rayleigh_dict['tprs'],rayleigh_dict['ttrs'],rayleigh_dict['urs'],rayleigh_dict['eps']]

    return(table)